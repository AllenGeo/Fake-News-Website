<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social Media - View Posts</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>Social Media</h1>
        <div class="header-buttons">
            <button id="postButton" class="post-button">Create Post</button>
            <button id="logoutButton" class="logout-button">Logout</button>
        </div>
    </header>

    <div class="container">
        <div class="posts" id="posts">
            <!-- Posts will be dynamically loaded here -->
        </div>
    </div>

    <script>
        // Redirect to post.html when the "Create Post" button is clicked
        const postButton = document.getElementById('postButton');
        postButton.addEventListener('click', () => {
            window.location.href = 'post.html';
        });
    
        // Redirect to login.html when the "Logout" button is clicked
        const logoutButton = document.getElementById('logoutButton');
        logoutButton.addEventListener('click', () => {
            window.location.href = 'log_in.html';
        });
    
        // Fetch posts from local storage or server
        const posts = JSON.parse(localStorage.getItem('posts')) || [];
    
        const postsContainer = document.getElementById('posts');
    
        posts.forEach((post, index) => {
            const postElement = document.createElement('div');
            postElement.classList.add('post');
    
            // Create title element
            const postTitle = document.createElement('h3');
            postTitle.textContent = post.title;
    
            // Create content element
            const postContent = document.createElement('p');
            postContent.textContent = post.content;
    
            // Create date and subject container
            const postMeta = document.createElement('div');
            postMeta.classList.add('post-meta');
    
            // Create date element
            const postDate = document.createElement('p');
            postDate.classList.add('date');
            postDate.textContent = `Date: ${post.date}`;
    
            // Create subject element
            const postSubject = document.createElement('p');
            postSubject.classList.add('subject');
            postSubject.textContent = `Subject: ${post.subject}`;
    
            // Append date and subject to post meta container
            postMeta.appendChild(postDate);
            postMeta.appendChild(postSubject);
    
            // Create Predict button
            const predictButton = document.createElement('button');
            predictButton.textContent = 'Predict';
            predictButton.addEventListener('click', () => {
                // Prepare the data to send
                const postData = {
                    title: post.title,
                    content: post.content,
                    subject: post.subject,
                    date: post.date,
                };
    
                // Send data to backend for prediction
                fetch('http://localhost:5000/predict', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(postData),
                })
                .then(response => response.json())
                .then(data => {
                    alert(`Prediction: ${data.target}`);
                })
                .catch(error => {
                    console.error('Error:', error);
                });
            });
    
            // Append elements to the post
            postElement.appendChild(postTitle);
            postElement.appendChild(postContent);
            postElement.appendChild(postMeta);
            postElement.appendChild(predictButton);
    
            // Add post to the posts container
            postsContainer.appendChild(postElement);
        });
    </script>    
</body>
</html>
